/*!
 * xq-admin-page v1.0.4 (https://xqkeji.cn/demo/xq-admin-page)
 * Author xqkeji.cn
 * LICENSE SSPL-1.0
 * Copyright 2023 xqkeji.cn
 */
 "use strict";(()=>{var P={tableClass:".xq-table",dragClass:".xq-drag",checkAllClass:".xq-table .xq-check-all",addBtnClass:".xq-table .xq-add",editBtnClass:".xq-edit",viewBtnClass:".xq-view",deleteBtnClass:".xq-delete",copyBtnClass:".xq-copy",batchBtnClass:".xq-batch",backPageClass:".xq-backpage",authTableClass:".xq-auth-table",authCheckTableClass:".xq-auth-check-table",authCheckRowClass:".xq-auth-check-row",captchaClass:".xq-captcha"};var o={};var t=(e={})=>{o=Object.assign({},P);if(e){for(const t in e){if(Object.hasOwn(o,t)){treegridOptions[t]=e[t]}}}};var f=e=>{if(e in o){return o[e]}const t=o["tableClass"];const n=document.querySelector(t);if(n.hasAttribute(e)){return String(n.getAttribute(e))}return""};var n;var a=()=>{if(n){return n}else{const e=f("tableClass");const t=document.querySelector(e);n=t;return n}};var e=e=>{if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",e)}else{e()}};var l=(e,t)=>{const n=[];let o=e.parentNode;while(o&&o.nodeType===Node.ELEMENT_NODE&&o.nodeType!==3){if(o.matches(t)){n.push(o)}o=o.parentNode}return n};var Y=(e,t)=>{let n=e.nextElementSibling;while(n){if(n.matches(t)){return[n]}n=n.nextElementSibling}return[]};var M=(e,t)=>{const n=document.createRange().createContextualFragment(t);e.append(n)};var j=e=>{const t={};const n=new FormData(e);for(const o of n){const r=o[0];if(r.includes("[")){const i=r.slice(0,Math.max(0,r.indexOf("[")));const a=r.slice(r.indexOf("[")+1,r.indexOf("]"));const s={};s[a]=o[1];if(t[i]){const l=t[i];l[a]=o[1];t[i]=l}else{t[i]=s}}else{t[o[0]]=o[1]}}return t};var z=()=>{const e=f("addBtnClass");const t=document.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;const n=l(t,"table")[0];const o=n.getAttribute("pid");let r=t.getAttribute("xq-url");if(!r){r=window.location.href;if(r.includes(".html")||r.includes("localhost")){r=r.slice(0,Math.max(0,r.lastIndexOf("/")));r+="/add.html"}else{if(o){r=r.replace("/"+o,"")}r=r.slice(0,Math.max(0,r.lastIndexOf("/")));r+=o?"/add/"+o:"/add"}}window.location.href=r})}};var W='<div id="xq-bs-modal" class="modal" tabindex="-1" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"><i></i><span>title</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p>Modal content.</p></div><div class="modal-footer"></div></div></div></div>';var F={id:"xq-bs-modal",type:"alert",size:"modal-sm",position:"modal-dialog-centered",template:W,title:"提示信息",content:"您确认要进行操作吗?",icon:"info",confirmButton:"确认",cancelButton:"取消",confirmButtonClass:"btn-primary",cancelButtonClass:"btn-secondary",confirm:()=>{},cancel:()=>{},backgroundDismiss:true,autoClose:false};var r={};var R=(e={})=>{r=Object.assign({},F);if(e){for(const t in e){if(Object.prototype.hasOwnProperty.call(r,t)){r[t]=e[t]}}}};var O=e=>{if(e in r){return r[e]}const t=r["id"];const n=document.querySelector("#"+t);if(n.hasAttribute(e)){return String(n.getAttribute(e))}return""};var X={info:"bi bi-info-circle-fill link-primary",warn:"bi bi-info-circle-fill link-warning",error:"bi bi-info-circle-fill link-danger"};var J=e=>{if(Object.prototype.hasOwnProperty.call(X,e)){return X[e]}else{return e}};var V=(e={})=>{R(e);const t=O("template");M(document.body,t);const n=O("id");const r=document.querySelector("#"+n);if(r){const o=r.querySelector(".modal-dialog");const i=O("size");const a=O("position");o.classList.add(i);o.classList.add(a);const s=r.querySelector(".modal-title>i");const l=r.querySelector(".modal-title>span");const c=r.querySelector(".modal-body>p");if(s){const d=O("icon");const f=J(d);s.className=f}if(l){const u=O("title");l.innerHTML=u}if(c){const m=O("content");c.innerHTML=m}if(typeof bootstrap!==void 0&&typeof bootstrap.Modal!==void 0){const p=new bootstrap.Modal(r);const h=document.querySelector(".modal-footer");if(h){const v=O("type");if(v!=="alert"){const E=O("cancelButtonClass");const x=O("cancelButton");M(h,'<button id="xq-bs-modal-cancel" type="button" class="btn '+E+'" data-bs-dismiss="modal">'+x+"</button>");const C=h.querySelector("#xq-bs-modal-cancel");C?.addEventListener("click",e=>{e.preventDefault();p.hide();const t=O("cancel");if(t!==null){t()}})}const b=O("confirmButtonClass");const y=O("confirmButton");M(h,'<button id="xq-bs-modal-confirm" type="button" class="btn '+b+'">'+y+"</button>");const w=h.querySelector("#xq-bs-modal-confirm");w?.addEventListener("click",e=>{e.preventDefault();p.hide();const t=O("confirm");if(t!==null){t()}})}r.addEventListener("hidden.bs.modal",()=>{p.dispose();r.remove()});const g=O("autoClose");if(g){const q=g;if(q.indexOf("|")){const S=q.split("|");const T=S[0];const A=Number.parseInt(S[1],10);let t;let n;let o=Math.ceil(A/1e3);const L='<span class="countdown"> ('+o+")</span>";if(T==="confirm"){n=h.querySelector("#xq-bs-modal-confirm");M(n,L)}else{n=h.querySelector("#xq-bs-modal-cancel");M(n,L)}r.addEventListener("show.bs.modal",()=>{t=setInterval(function(){const e=n.querySelector(".countdown");o=o-1;e.innerHTML=" ("+o+") ";if(o<=0){clearInterval(t);n.click()}},1e3)})}}p.show()}else{console.log("error","the bootstrap not loaded!")}}};var c=(e={})=>{V(e)};window.xqConfirm=c;var U=i=>{const e=f("editBtnClass");const t=i.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;const n=a();const o=n?.getAttribute("pid");let r=i.getAttribute("id");r=r.replace("xq_","");if(r){let e=t.getAttribute("xq-url");if(!e){e=window.location.href;if(e.includes(".html")||e.endsWith("/")){e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e=e+"/edit.html?id="+r}else{if(o){e=e.replace("/"+o,"")}e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e=e+"/edit/"+r}}window.location.href=e}else{c({content:"找不到tr的id属性！"})}})}};var Q=i=>{const e=f("viewBtnClass");const t=i.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;const n=a();const o=n?.getAttribute("pid");let r=i.getAttribute("id");r=r.replace("xq_","");if(r){let e=t.getAttribute("xq-url");if(!e){e=window.location.href;if(e.includes(".html")||e.endsWith("/")){e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e=e+"/view.html?id="+r}else{if(o){e=e.replace("/"+o,"")}e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e=e+"/view/"+r}}window.location.href=e}else{c({content:"找不到tr的id属性！"})}})}};var G=e=>{const t=document.createElement("input");t.setAttribute("value",e);document.body.append(t);t.select();document.execCommand("copy");t.remove()};var K=t=>{const e=f("copyBtnClass");const n=t.querySelector(e);if(n){n.addEventListener("click",()=>{let e=t.getAttribute("id");e=e.replace("xq_","");if(e){G(e);c({content:"已经将id复制到粘贴板"})}})}};var Z=i=>{const e=f("deleteBtnClass");const t=i.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;const n=a();const o=n?.getAttribute("pid");let r=i.getAttribute("id");r=r.replace("xq_","");if(r){let e=t.getAttribute("xq-url");if(!e){e=window.location.href;if(o){e=e.replace("/"+o,"")}e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e+="/delete"}c({content:"确定要删除吗？",confirm(){fetch(e,{body:JSON.stringify({id:r}),headers:{"content-type":"application/json"},method:"POST"}).then(async e=>{return e.json()}).then(e=>{c({content:e.message,confirm(){if(e.code===200){window.location.reload()}}})})}})}else{c({content:"找不到tr的id属性！"})}})}};var ee=e=>{const l=a();let c=e.getAttribute("id");c=c?.replace("xq_","");const t=e.querySelectorAll("input,select");for(const n of t){const o=n.getAttribute("id");if(o!=="id"&&o!=="check_all"){n.addEventListener("change",e=>{const t=e.currentTarget;let n=null;n=t.type==="checkbox"?t.checked:t.value;const o=t.getAttribute("id");const r=o?.slice(0,Math.max(0,o.indexOf("_")));const i=l?.getAttribute("pid");let a=l?.getAttribute("xq-url");const s={id:c,field:r,value:n};if(!a){let e=window.location.href;if(i){e=e.replace("/"+i,"")}e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e+="/change";a=e}else{a+="/change"}fetch(a,{body:JSON.stringify(s),headers:{"content-type":"application/json"},method:"POST"}).then(async e=>{return e.json()}).then(e=>{console.log(e)})})}}};var te=()=>{const e=f("batchBtnClass");const t=document.querySelectorAll(e);if(t){for(const n of t){n.addEventListener("click",e=>{const t=e.currentTarget;const n=l(t,"table")[0];const o=n.getAttribute("pid");const r=l(t,"form")[0];const i=t.getAttribute("name");if(i){let e=t.getAttribute("xq-url");if(!e){e=window.location.href;if(o){e=e.replace("/"+o,"")}e=e.slice(0,Math.max(0,e.lastIndexOf("/")));e=e+"/"+i}const a=j(r);const s=JSON.stringify(a);if(s!=="{}"){c({content:"确定要进行批量操作吗？",confirm(){fetch(e,{body:s,headers:{"content-type":"application/json"},method:"POST"}).then(async e=>{return e.json()}).then(e=>{c({content:e.message,confirm(){if(e.code===200){window.location.reload()}}})})}})}else{c({content:"没有选择操作数据."})}}})}}};function d(e,t,n){if(n===void 0){return e&&e.h5s&&e.h5s.data&&e.h5s.data[t]}else{e.h5s=e.h5s||{};e.h5s.data=e.h5s.data||{};e.h5s.data[t]=n}}function ne(e){if(e.h5s){delete e.h5s.data}}var g=(e,t)=>{if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array)){throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.")}if(typeof t!=="string"){return Array.from(e)}return Array.from(e).filter(e=>e.nodeType===1&&e.matches(t))};var v=new Map;var oe=class{constructor(){this._config=new Map;this._placeholder=void 0;this._data=new Map}set config(e){if(typeof e!=="object"){throw new Error("You must provide a valid configuration object to the config setter.")}const t=Object.assign({},e);this._config=new Map(Object.entries(t))}get config(){const n={};this._config.forEach((e,t)=>{n[t]=e});return n}setConfig(e,t){if(!this._config.has(e)){throw new Error(`Trying to set invalid configuration item: ${e}`)}this._config.set(e,t)}getConfig(e){if(!this._config.has(e)){throw new Error(`Invalid configuration item requested: ${e}`)}return this._config.get(e)}get placeholder(){return this._placeholder}set placeholder(e){if(!(e instanceof HTMLElement)&&e!==null){throw new Error("A placeholder must be an html element or null.")}this._placeholder=e}setData(e,t){if(typeof e!=="string"){throw new Error("The key must be a string.")}this._data.set(e,t)}getData(e){if(typeof e!=="string"){throw new Error("The key must be a string.")}return this._data.get(e)}deleteData(e){if(typeof e!=="string"){throw new Error("The key must be a string.")}return this._data.delete(e)}};var b=e=>{if(!(e instanceof HTMLElement)){throw new Error("Please provide a sortable to the store function.")}if(!v.has(e)){v.set(e,new oe)}return v.get(e)};function s(t,n,o){if(t instanceof Array){for(let e=0;e<t.length;++e){s(t[e],n,o)}return}t.addEventListener(n,o);b(t).setData(`event${n}`,o)}function i(t,n){if(t instanceof Array){for(let e=0;e<t.length;++e){i(t[e],n)}return}t.removeEventListener(n,b(t).getData(`event${n}`));b(t).deleteData(`event${n}`)}function u(t,n,o){if(t instanceof Array){for(let e=0;e<t.length;++e){u(t[e],n,o)}return}t.setAttribute(n,o)}function m(t,n){if(t instanceof Array){for(let e=0;e<t.length;++e){m(t[e],n)}return}t.removeAttribute(n)}var y=e=>{if(!e.parentElement||e.getClientRects().length===0){throw new Error("target element must be part of the dom")}const t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}};var re=(t,n=0)=>{let o;return(...e)=>{clearTimeout(o);o=setTimeout(()=>{t(...e)},n)}};var w=(e,t)=>{if(!(e instanceof HTMLElement)||!(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)){throw new Error("You must provide an element and a list of elements.")}return Array.from(t).indexOf(e)};var ie=e=>{if(!(e instanceof HTMLElement)){throw new Error("Element is not a node element.")}return e.parentNode!==null};var ae=(e,t,n)=>{if(!(e instanceof HTMLElement)||!(e.parentElement instanceof HTMLElement)){throw new Error("target and element must be a node")}e.parentElement.insertBefore(t,n==="before"?e:e.nextElementSibling)};var se=(e,t)=>ae(e,t,"before");var le=(e,t)=>ae(e,t,"after");var ce=(t,n=(e,t)=>e,e=e=>e)=>{if(!(t instanceof HTMLElement)||!t.isSortable===true){throw new Error("You need to provide a sortableContainer to be serialized.")}if(typeof n!=="function"||typeof e!=="function"){throw new Error("You need to provide a valid serializer for items and the container.")}const o=d(t,"opts");const r=o.items;const i=g(t.children,r);const a=i.map(e=>{return{parent:t,node:e,html:e.outerHTML,index:w(e,i)}});const s={node:t,itemCount:a.length};return{container:e(s),items:a.map(e=>n(e,t))}};var de=(e,t,n="sortable-placeholder")=>{if(!(e instanceof HTMLElement)){throw new Error("You must provide a valid element as a sortable.")}if(!(t instanceof HTMLElement)&&t!==void 0){throw new Error("You must provide a valid element as a placeholder or set ot to undefined.")}if(t===void 0){if(["UL","OL"].includes(e.tagName)){t=document.createElement("li")}else if(["TABLE","TBODY"].includes(e.tagName)){t=document.createElement("tr");t.innerHTML='<td colspan="100"></td>'}else{t=document.createElement("div")}}if(typeof n==="string"){t.classList.add(...n.split(" "))}return t};var fe=e=>{if(!(e instanceof HTMLElement)){throw new Error("You must provide a valid dom element")}const n=window.getComputedStyle(e);if(n.getPropertyValue("box-sizing")==="border-box"){return parseInt(n.getPropertyValue("height"),10)}return["height","padding-top","padding-bottom"].map(e=>{const t=parseInt(n.getPropertyValue(e),10);return isNaN(t)?0:t}).reduce((e,t)=>e+t)};var ue=e=>{if(!(e instanceof HTMLElement)){throw new Error("You must provide a valid dom element")}const n=window.getComputedStyle(e);return["width","padding-left","padding-right"].map(e=>{const t=parseInt(n.getPropertyValue(e),10);return isNaN(t)?0:t}).reduce((e,t)=>e+t)};var p=(e,t)=>{if(!(e instanceof Array)){throw new Error("You must provide a Array of HTMLElements to be filtered.")}if(typeof t!=="string"){return e}return e.filter(e=>{return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement}).map(e=>{return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)})};var E=e=>{return e.composedPath&&e.composedPath()[0]||e.target};var me=(e,t,n)=>{return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}};var pe=(e,t,n)=>{if(!(e instanceof Event)){throw new Error("setDragImage requires a DragEvent as the first argument.")}if(!(t instanceof HTMLElement)){throw new Error("setDragImage requires the dragged element as the second argument.")}if(!n){n=me}if(e.dataTransfer&&e.dataTransfer.setDragImage){const o=y(t);const r=n(t,o,e);if(!(r.element instanceof HTMLElement)||typeof r.posX!=="number"||typeof r.posY!=="number"){throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].")}e.dataTransfer.effectAllowed="copyMove";e.dataTransfer.setData("text/plain",E(e).id);e.dataTransfer.setDragImage(r.element,r.posX,r.posY)}};var he=(e,t)=>{if(e.isSortable===true){const n=b(e).getConfig("acceptFrom");if(n!==null&&n!==false&&typeof n!=="string"){throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.')}if(n!==null){return n!==false&&n.split(",").filter(function(e){return e.length>0&&t.matches(e)}).length>0}if(e===t){return true}if(b(e).getConfig("connectWith")!==void 0&&b(e).getConfig("connectWith")!==null){return b(e).getConfig("connectWith")===b(t).getConfig("connectWith")}}return false};var ge={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:false,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:false,dropTargetContainerClass:false,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};function ve(n,o=250){if(typeof n!=="function"){throw new Error("You must provide a function as the first argument for throttle.")}if(typeof o!=="number"){throw new Error("You must provide a number as the second argument for throttle.")}let r=null;return(...e)=>{const t=Date.now();if(r===null||t-r>=o){r=t;n.apply(this,e)}}}var h=(e,t)=>{if(typeof b(e).getConfig("hoverClass")==="string"){const n=b(e).getConfig("hoverClass").split(" ");if(t===true){s(e,"mousemove",ve(t=>{if(t.buttons===0){g(e.children,b(e).getConfig("items")).forEach(e=>{if(e===t.target||e.contains(t.target)){e.classList.add(...n)}else{e.classList.remove(...n)}})}},b(e).getConfig("throttleTime")));s(e,"mouseleave",()=>{g(e.children,b(e).getConfig("items")).forEach(e=>{e.classList.remove(...n)})})}else{i(e,"mousemove");i(e,"mouseleave")}}};var x;var C;var q;var S;var T;var A;var L;var k;var I;var D=function(e){i(e,"dragstart");i(e,"dragend");i(e,"dragover");i(e,"dragenter");i(e,"drop");i(e,"mouseenter");i(e,"mouseleave")};var H=function(e,t){if(e){i(e,"dragleave")}if(t&&t!==e){i(t,"dragleave")}};var be=function(e,t){let n=e;if(b(t).getConfig("copy")===true){n=e.cloneNode(true);u(n,"aria-copied","true");e.parentElement.appendChild(n);n.style.display="none";n.oldDisplay=e.style.display}return n};var ye=function(e){ne(e);m(e,"aria-dropeffect")};var we=function(e){m(e,"aria-grabbed");m(e,"aria-copied");m(e,"draggable");m(e,"role")};function _(e,t){if(t.composedPath){return t.composedPath().find(e=>e.isSortable)}while(e.isSortable!==true){e=e.parentElement}return e}function Ee(e,t){const n=d(e,"opts");const o=g(e.children,n.items);const r=o.filter(function(e){return e.contains(t)||e.shadowRoot&&e.shadowRoot.contains(t)});return r.length>0?r[0]:t}var xe=function(e){const t=d(e,"opts")||{};const n=g(e.children,t.items);const o=p(n,t.handle);h(e,false);i(e,"dragover");i(e,"dragenter");i(e,"dragstart");i(e,"dragend");i(e,"drop");ye(e);i(o,"mousedown");D(n);we(n);H(S,k);e.isSortable=false};var Ce=function(e){const t=d(e,"opts");const n=g(e.children,t.items);const o=p(n,t.handle);u(e,"aria-dropeffect","move");d(e,"_disabled","false");u(o,"draggable","true");h(e,true);if(t.disableIEFix===false){const r=(document||window.document).createElement("span");if(typeof r.dragDrop==="function"){s(o,"mousedown",function(){if(n.indexOf(this)!==-1){this.dragDrop()}else{let e=this.parentElement;while(n.indexOf(e)===-1){e=e.parentElement}e.dragDrop()}})}}};var qe=function(e){const t=d(e,"opts");const n=g(e.children,t.items);const o=p(n,t.handle);u(e,"aria-dropeffect","none");d(e,"_disabled","true");u(o,"draggable","false");i(o,"mousedown");h(e,false)};var Se=function(e){const t=d(e,"opts");const n=g(e.children,t.items);const o=p(n,t.handle);d(e,"_disabled","false");D(n);H(S,k);i(o,"mousedown");i(e,"dragover");i(e,"dragenter");i(e,"drop")};function B(e,h){const i=String(h);h=h||{};if(typeof e==="string"){e=document.querySelectorAll(e)}if(e instanceof HTMLElement){e=[e]}e=Array.prototype.slice.call(e);if(/serialize/.test(i)){return e.map(e=>{const t=d(e,"opts");return ce(e,t.itemSerializer,t.containerSerializer)})}e.forEach(function(l){if(/enable|disable|destroy/.test(i)){return B[i](l)}["connectWith","disableIEFix"].forEach(e=>{if(Object.prototype.hasOwnProperty.call(h,e)&&h[e]!==null){console.warn(`HTML5Sortable: You are using the deprecated configuration "${e}". This will be removed in an upcoming version, make sure to migrate to the new options when updating.`)}});h=Object.assign({},ge,b(l).config,h);b(l).config=h;d(l,"opts",h);l.isSortable=true;Se(l);const e=g(l.children,h.items);let t;if(h.placeholder!==null&&h.placeholder!==void 0){const o=document.createElement(l.tagName);if(h.placeholder instanceof HTMLElement){o.appendChild(h.placeholder)}else{o.innerHTML=h.placeholder}t=o.children[0]}b(l).placeholder=de(l,t,h.placeholderClass);d(l,"items",h.items);if(h.acceptFrom){d(l,"acceptFrom",h.acceptFrom)}else if(h.connectWith){d(l,"connectWith",h.connectWith)}Ce(l);u(e,"role","option");u(e,"aria-grabbed","false");s(l,"dragstart",function(e){const t=E(e);if(t.isSortable===true){return}e.stopImmediatePropagation();if(h.handle&&!t.matches(h.handle)||t.getAttribute("draggable")==="false"){return}const n=_(t,e);const o=Ee(n,t);L=g(n.children,h.items);T=L.indexOf(o);A=w(o,n.children);S=n;pe(e,o,h.customDragImage);C=fe(o);q=ue(o);o.classList.add(h.draggingClass);x=be(o,n);u(x,"aria-grabbed","true");n.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:A,index:T,container:S},item:x,originalTarget:t,dragEvent:e}}))});s(l,"dragenter",e=>{const n=E(e);const o=_(n,e);if(o&&o!==k){I=g(o.children,d(o,"items")).filter(e=>e!==b(l).placeholder);if(h.dropTargetContainerClass){o.classList.add(h.dropTargetContainerClass)}o.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:A,index:T,container:S},destination:{container:o,itemsBeforeUpdate:I},item:x,originalTarget:n}}));s(o,"dragleave",function(e){const t=e.relatedTarget||e.fromElement;if(!e.currentTarget.contains(t)){if(h.dropTargetContainerClass){o.classList.remove(h.dropTargetContainerClass)}o.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:A,index:T,container:o},item:x,originalTarget:n}}))}})}k=o});s(l,"dragend",function(e){if(!x){return}x.classList.remove(h.draggingClass);u(x,"aria-grabbed","false");if(x.getAttribute("aria-copied")==="true"&&d(x,"dropped")!=="true"){x.remove()}if(x.oldDisplay!==void 0){x.style.display=x.oldDisplay;delete x.oldDisplay}const t=Array.from(v.values()).map(e=>e.placeholder).filter(e=>e instanceof HTMLElement).filter(ie)[0];if(t){t.remove()}l.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:A,index:T,container:S},item:x,dragEvent:e}}));k=null;x=null;C=null;q=null});s(l,"drop",function(e){if(!he(l,x.parentElement)){return}e.preventDefault();e.stopPropagation();d(x,"dropped","true");const t=Array.from(v.values()).map(e=>{return e.placeholder}).filter(e=>e instanceof HTMLElement).filter(ie)[0];if(t){t.replaceWith(x);if(x.oldDisplay!==void 0){x.style.display=x.oldDisplay;delete x.oldDisplay}}else{d(x,"dropped","false");return}const n=b(l).placeholder;const o=g(S.children,h.items).filter(e=>e!==n);const r=this.isSortable===true?this:this.parentElement;const i=g(r.children,d(r,"items")).filter(e=>e!==n);const a=w(x,Array.from(x.parentElement.children).filter(e=>e!==n));const s=w(x,i);if(h.dropTargetContainerClass){r.classList.remove(h.dropTargetContainerClass)}l.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:A,index:T,container:S},item:x,destination:{index:s,elementIndex:a,container:r,itemsBeforeUpdate:I,items:i},dragEvent:e}}));if(A!==a||S!==r){l.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:A,index:T,container:S,itemsBeforeUpdate:L,items:o},destination:{index:s,elementIndex:a,container:r,itemsBeforeUpdate:I,items:i},item:x,dragEvent:e}}))}});const r=re((n,e,o,r)=>{if(!x){return}if(h.forcePlaceholderSize){b(n).placeholder.style.height=C+"px";b(n).placeholder.style.width=q+"px"}if(Array.from(n.children).indexOf(e)>-1){const i=fe(e);const a=ue(e);const s=w(b(n).placeholder,e.parentElement.children);const l=w(e,e.parentElement.children);if(i>C||a>q){const c=i-C;const d=a-q;const f=y(e).top;const u=y(e).left;if(s<l&&(h.orientation==="vertical"&&r<f||h.orientation==="horizontal"&&o<u)){return}if(s>l&&(h.orientation==="vertical"&&r>f+i-c||h.orientation==="horizontal"&&o>u+a-d)){return}}if(x.oldDisplay===void 0){x.oldDisplay=x.style.display}if(x.style.display!=="none"){x.style.display="none"}let t=false;try{const m=y(e).top+e.offsetHeight/2;const p=y(e).left+e.offsetWidth/2;t=h.orientation==="vertical"&&r>=m||h.orientation==="horizontal"&&o>=p}catch(e){t=s<l}if(t){le(e,b(n).placeholder)}else{se(e,b(n).placeholder)}Array.from(v.values()).filter(e=>e.placeholder!==void 0).forEach(e=>{if(e.placeholder!==b(n).placeholder){e.placeholder.remove()}})}else{const t=Array.from(v.values()).filter(e=>e.placeholder!==void 0).map(e=>{return e.placeholder});if(t.indexOf(e)===-1&&n===e&&!g(e.children,h.items).length){t.forEach(e=>e.remove());e.appendChild(b(n).placeholder)}}},h.debounce);const n=function(e){let t=e.target;const n=t.isSortable===true?t:_(t,e);t=Ee(n,t);if(!x||!he(n,x.parentElement)||d(n,"_disabled")==="true"){return}const o=d(n,"opts");if(parseInt(o.maxItems)&&g(n.children,d(n,"items")).length>=parseInt(o.maxItems)&&x.parentElement!==n){return}e.preventDefault();e.stopPropagation();e.dataTransfer.dropEffect=b(n).getConfig("copy")===true?"copy":"move";r(n,t,e.pageX,e.pageY)};s(e.concat(l),"dragover",n);s(e.concat(l),"dragenter",n)});return e}B.destroy=function(e){xe(e)};B.enable=function(e){Ce(e)};B.disable=function(e){qe(e)};B.__testing={data:d,removeItemEvents:D,removeItemData:we,removeSortableData:ye,removeContainerEvents:H};var Te=()=>{const t=f("dragClass");const s=document.querySelector(t);if(s){let e=s.querySelector("tbody");if(e){const n=e.querySelector("tbody>tr:first-child");const o=n.getAttribute("id");const r=n.querySelector("td:first-child");r?.classList.add("xq-move");e.setAttribute("id","tbody_"+o);const i=e.querySelectorAll("tbody>tr:not(:first-child)");for(const a of i){const l=a.querySelector("td:first-child");l?.classList.add("xq-move");const c=document.createElement("tbody");c.append(a);const d=a.getAttribute("id");c.setAttribute("id","tbody_"+d);e.after(c);e=c}}B(t,{items:"tbody",handle:".xq-move",placeholder:'<tbody><tr><td colspan="99">&nbsp;</td></tr><tbody>'});s.addEventListener("sortstop",()=>{const n=[];let o=0;const e=s.querySelectorAll("tbody");for(const i of e){o++;const e=i.querySelector("tr:first-child");const t=e?.getAttribute("id");const a={id:t,ordernum:o};n.push(a)}const t=s.getAttribute("pid");let r=s.getAttribute("xq-url");if(!r){r=window.location.href;if(t){r=r.replace("/"+t,"")}r=r.slice(0,Math.max(0,r.lastIndexOf("/")));r+="/b-order"}fetch(r,{body:JSON.stringify(n),headers:{"content-type":"application/json"},method:"POST"}).then(async e=>{return e.json()}).then(e=>{if(e.code===200){}})})}};var Ae=()=>{const e=f("checkAllClass");const t=document.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;const{checked:n}=t;const o=a();const r=o?.querySelectorAll("tr > td:first-child > input[type=checkbox]");for(const i of r){if(i===t){continue}if(n){i.checked=true}else{i.checked=false}}})}};var Le=()=>{let e;let t;let n;const o=f("backPageClass");const r=document.querySelectorAll(o);if(r){e=document.referrer;n=null;if(window.top!==window){try{n=window.top?.location.href}catch(e){}}if(e&&e!==document.location.href&&e!==n){sessionStorage.setItem(document.location.href,e);t=e}else{const i=sessionStorage.getItem(document.location.href);if(i){t=i.toString()}}for(const a of r){a.addEventListener("click",e=>{e.preventDefault();if(t){document.location.href=t}else{c({content:"系统无法自动返回上一个页面."})}})}}};var Me=()=>{const e=f("authTableClass");const t=document.querySelectorAll(e);if(t){for(const i of t){const a=f("authCheckTableClass");const n=i.querySelector(a);if(n){const s=n.querySelector("input[type=checkbox]");if(s){s.addEventListener("click",e=>{const t=e.currentTarget;const{checked:n}=t;const o=i.querySelectorAll("input[type=checkbox]:not("+a+">input[type=checkbox])");for(const r of o){if(n){r.checked=true}else{r.checked=false}}})}}const o=f("authCheckRowClass");const r=i.querySelectorAll(o);for(const l of r){const c=l.querySelector("input[type=checkbox]");if(c){c.addEventListener("click",e=>{const t=e.currentTarget;const{checked:n}=t;const o=Y(l,"td")[0];const r=o.querySelectorAll("input[type=checkbox]");for(const i of r){if(n){i.checked=true}else{i.checked=false}}})}}}}};var Oe=()=>{const t=document.querySelectorAll(".xq-fileinput");if(t&&typeof jQuery!==void 0){let e;for(const n of t){e=n.hasAttribute("xq-config")?n.getAttribute("xq-config"):"{}";$(n).fileinput(JSON.parse(e)).on("filedeleted",e=>{const t=e.currentTarget;N(t)}).on("fileuploaded",e=>{const t=e.currentTarget;N(t)}).on("filesorted",e=>{const t=e.currentTarget;N(t)});N(n)}}};var N=e=>{const t=e.getAttribute("id");const n=t.replace("-xq-fileinput","");const o=document.querySelector("#"+n);const r=$(e).fileinput("getPreview");o?.setAttribute("value",JSON.stringify(r));const i=$(e).fileinput("getFilesCount",true);const a=e.getAttribute("xq-config");const s=JSON.parse(a);if(s!==null&&"required"in s){if(i>0){e.removeAttribute("required")}else{e.setAttribute("required","true")}if("content"in r){const{content:l}=r;if(l.length===0){e.setCustomValidity("需要至少上传一个文件")}else{e.setCustomValidity("")}}}};var ke=()=>{const e=f("captchaClass");const t=document.querySelector(e);if(t){t.addEventListener("click",e=>{const t=e.currentTarget;let n=t.getAttribute("src");if(n.includes("?")){n=n.slice(0,Math.max(0,n.lastIndexOf("?")));n=n+"?xq-r="+Math.random().toString()}else{n=n+"?xq-r="+Math.random().toString()}t.setAttribute("src",n)})}};var Ie=()=>{const e=a();if(e){const t=e.querySelectorAll("tr");for(const n of t){Q(n);U(n);Z(n);ee(n);K(n)}Ae();z();te();Te()}Le();Me();Oe();ke()};var De=(e={})=>{t(e);Ie()};e(()=>{De()})})();